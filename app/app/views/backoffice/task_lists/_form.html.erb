<!-- app/views/backoffice/task_lists/_form.html.erb -->
<%= simple_form_for @task_list, url: @task_list.new_record? ? backoffice_task_lists_path : backoffice_task_list_path(@task_list), html: { data: { controller: "task-list" } } do |form| %>
  <% if @task_list.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@task_list.errors.count, "error") %> prohibited this task list from being saved:</h2>
      <ul>
        <% @task_list.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.input :name, label: "Task List Name" %>
  </div>

  <h2>Tasks</h2>
  <div id="tasks" data-task-list-target="tasks">
    <%= form.simple_fields_for :tasks do |task_form| %>
      <%= render 'task_fields', form: task_form %>
    <% end %>
  </div>

  <div class="mt-3">
    <%= button_tag "Add Task", type: "button", class: "btn btn-primary", data: { action: "task-list#addTask" } %>
  </div>

  <div class="actions">
    <%= form.button :submit, "Save Task List" %>
  </div>

  <template data-task-list-target="template">
    <%= form.simple_fields_for :tasks, Task.new, child_index: "NEW_RECORD" do |task_form| %>
      <%= render 'task_fields', form: task_form %>
    <% end %>
  </template>
<% end %>
